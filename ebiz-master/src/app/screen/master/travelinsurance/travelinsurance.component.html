<div class="col-12" *ngIf="emp_list.length > 0" style="height: auto">
  <div class="row math-height">
    <div class="col-lg-12">
      <div class="card box-shadow-1 mt-3">
        <div class="card-body m-0 p-0" #cardTag>
          <!-- <div class="row col-lg-12 pb-4">
                    </div> -->
          <div class="container-fluid">
            <div class="row">
              <!-- <div class="row"> -->
              <div class="col-lg-6 col-md-6 col-sm-12" style="min-height: 67px">
                <div class="marker marker-ribbon marker-top-blue pos-absolute mt-4 l-0 pl-5 pr-5">
                  <p class="tx-24 m-0 text-uppercase d-flex align-items-center justify-content-around">
                    &#32;
                    <span class="material-icons tx-24 font-weight-bold valign-middle white mx-2">
                      airplanemode_active
                    </span>
                    &#32;TRAVELINSURANCE
                  </p>
                </div>
              </div>

              <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="container px-0">
                  <div class="text-right mt-4 pr-4" *ngIf="status != true">
                    <p class="tx-24 m-0 tx-top-blue text-bold-500">
                      {{ namex }}
                    </p>
                  </div>
                  <div class="mt-4 col-12 col-md-10 col-lg-8 ml-md-auto" *ngIf="status">
                    <mat-select #select [(ngModel)]="empid" (selectionChange)="update_userByDOC()" class="form-control line-height-2 tx-gray-700 text-bold-500" placeholder="Select">
                      <mat-option *ngFor="let topping of emp_list; let i = index" [value]="topping.emp_id">
                        {{ topping.userDisplay }}
                      </mat-option>
                    </mat-select>
                  </div>
                  <div class="text-right mt-4 pr-4" *ngIf="pathPhase1">
                    <span class="link-text">
                      <p class="tx-14 m-0 text-bold-500" (click)="OpenDocument(doc_id, pathPhase1)">
                        Document No: {{ doc_id }}
                      </p>
                      <i class="fa fa-external-link ml-1"></i>
                    </span>
                  </div>
                </div>
              </div>
              <!-- </div> -->
              <!-- ** Traveler Detail -->
              <div class="col-12" *ngIf="userDetail">
                <div class="container border-bottom-3 border-bottom-grey-blue border-bottom-lighten-5 mb-4 py-4">
                  <div class="row no-gutters">
                    <p class="col-4 col-lg-2 col-md-2 tx-gray-700 tx-14 text-dark text-bold-500">Travel Topic :</p>
                    <p class="col-8 col-lg-10 col-md-10 tx-gray-700 tx-14 text-bold-500 text-capitalize">
                      {{ userDetail.travel_topic ? userDetail.travel_topic : '' }}
                    </p>
                    <p class="col-4 col-md-2 tx-gray-700 tx-14 text-dark text-bold-500">Business Date :</p>
                    <p class="col-8 col-md-4 tx-gray-700 tx-14 text-bold-500">
                      {{ userDetail.business_date ? userDetail.business_date : '' }}
                    </p>
                    <p class="col-4 col-md-2 offset-0 offset-md-1 tx-gray-700 tx-14 m-0 text-dark text-bold-500">
                      Travel Date :
                    </p>
                    <p class="col-8 col-md-4 tx-gray-700 tx-14 text-bold-500">
                      {{ userDetail.travel_date ? userDetail.travel_date : '' }}
                    </p>
                    <p class="col-4 col-md-2 tx-gray-700 tx-14 text-dark text-bold-500">Country / City :</p>
                    <p class="col-8 col-md-4 tx-gray-700 tx-14 text-bold-500">
                      {{ userDetail.country_city ? userDetail.country_city : '' }}
                    </p>
                    <p class="col-4 col-md-2 tx-gray-700 tx-14 text-dark text-bold-500">Total Traveler(s) :</p>
                    <p class="col-8 col-md-4 tx-gray-700 tx-14 text-bold-500">{{ emp_list.length }} Person(s)</p>
                  </div>
                </div>
              </div>
              <!-- ** Traveler Detail -->

              <div class="col-12 py-3 mt-0 mb-4">
                <div class="row justify-content-center align-items-baseline">
                  <ul id="progressbar" class="px-0 px-md-1 mb-0">
                    <li class="cursor-pointer" [ngClass]="{ active: docStatus(1) }" id="time"><strong></strong></li>
                    <li class="cursor-pointer" [ngClass]="{ active: docStatus(2) }" id="pencil"><strong></strong></li>
                    <li class="cursor-pointer" [ngClass]="{ active: docStatus(3) }" id="cog"><strong></strong></li>
                    <li class="cursor-pointer" [ngClass]="{ active: docStatus(4) }" id="check"><strong></strong></li>
                  </ul>
                </div>
              </div>

              <div class="col-12">
                <div class="container">
                  <button #dddd class="btn btn-round bg-top-pink col-3 font-weight-bold tx-14 d-none" style="color: white">
                    Add TravelInsurance
                  </button>
                  <div class="col-12 py-2 px-0 d-none">
                    <button class="btn btn-round bg-top-pink col-3 font-weight-bold tx-14 d-none" style="color: white">
                      Add TravelInsurance
                    </button>
                  </div>
                  <ng-container *ngFor="let dt of XorderBy(); let i = index; last as lastrow">
                    <ng-container *ngIf="dt.emp_id == empid && dt.action_type != 'delete'">
                      <mat-expansion-panel [expanded]="dt.panelx" [class.mb-4]="!lastrow">
                        <mat-expansion-panel-header id="clickMe2" #clickMe2 (click)="dt.panelx = !dt.panelx" [collapsedHeight]="'32px'" [expandedHeight]="'32px'">
                          <div class="col-6 float-left px-0" style="vertical-align: bottom">
                            <h5 class="tx-gray-700 pt- my-0" style="vertical-align: bottom">
                              Travel Insurance {{ i + 1 }}
                            </h5>
                          </div>
                          <div class="col-6 float-right" style="vertical-align: bottom" [hidden]="!show_button">
                            <span (click)="deleterow(dt.id, dt.emp_id)" style="vertical-align: bottom" class="fa fa-minus-circle danger cursor-pointer tx-18 float-right pt-2" aria-hidden="true"></span>
                            <!-- *ngIf="i == data_retune(dt.emp_id).length - 1" -->
                            <span *ngIf="dt.id == data_retune(dt.emp_id)" (click)="addrow(dt.emp_id)" class="fa fa-plus-circle success cursor-pointer tx-18 float-right mr-2 pt-2" aria-hidden="true">
                            </span>
                          </div>
                        </mat-expansion-panel-header>

                        <div class="col-12 px-0 pb-2 pt-0 mt-0 mb-4">
                          <div class="col-12 mx-0 px-0">
                            <div>
                              <div class="row col-12 py-2 px-0 mx-0">
                                <div class="col-12 tx-gray-700 tx-14 m-0 text-bold-500 text-white" style="background-color: #08508c">
                                  <p class="mb-0" style="text-decoration: underline">Employee Information</p>
                                </div>
                              </div>

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500">Employee ID :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" disabled autocomplete="off" [(ngModel)]="dt.ins_emp_id" class="form-control" />
                                  </div>
                                </div>
                                <div class="col-md-8 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, Name_SetAll) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Policy Holder :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" [ngClass]="
                                        check_el(dt.id, Name_SetAll) == true && dt.submit_active == 'active'
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [disabled]="!show_button" [(ngModel)]="Name_SetAll" (ngModelChange)="ChangAllname(dt.id, dt.emp_id, Name_SetAll)" class="form-control" />
                                  </div>
                                </div>
                                <!-- [(ngModel)]="dt.ins_emp_name" -->
                              </div>

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500">Passport No :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" disabled autocomplete="off" [(ngModel)]="dt.ins_emp_passport" class="form-control" />
                                  </div>
                                </div>
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500">Organization Unit :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" disabled autocomplete="off" [(ngModel)]="dt.ins_emp_org" class="form-control" />
                                  </div>
                                </div>
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500">Occupation :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" disabled autocomplete="off" [(ngModel)]="dt.ins_emp_occupation" class="form-control" />
                                  </div>
                                </div>
                              </div>

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500">Age :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" disabled autocomplete="off" [(ngModel)]="dt.ins_emp_age" class="form-control" />
                                  </div>
                                </div>
                                <div class="col-md-8 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.insurance_company) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Company Name / Billing to :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" [ngClass]="
                                        check_el(dt.id, dt.insurance_company) == true && dt.submit_active == 'active'
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [disabled]="!show_button" [(ngModel)]="dt.insurance_company" class="form-control" />
                                  </div>
                                  <!-- [(ngModel)]="text_company" -->
                                </div>
                              </div>

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.ins_emp_address) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Address :</label>
                                  <div class="custom-file w-100">
                                    <textarea type="" class="" rows="3" id="passportno_input" [disabled]="!show_button" [ngClass]="
                                        check_el(dt.id, dt.ins_emp_address) == true && dt.submit_active == 'active'
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [(ngModel)]="dt.ins_emp_address" class="form-control"></textarea>
                                  </div>
                                </div>
                              </div>

                              <!-- <hr> -->

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-md-8 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.name_beneficiary) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Name of Beneficiary <span class="red">*</span> :
                                  </label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" [disabled]="!show_button" id="passportno_input" [ngClass]="
                                        check_el(dt.id, dt.name_beneficiary) == true && dt.submit_active == 'active'
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [(ngModel)]="dt.name_beneficiary" class="form-control" />
                                  </div>
                                </div>
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.relationship) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Relationship <span class="red">*</span> :
                                  </label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" [disabled]="!show_button" id="passportno_input" [ngClass]="
                                        check_el(dt.id, dt.relationship) == true && dt.submit_active == 'active'
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [(ngModel)]="dt.relationship" class="form-control" />
                                  </div>
                                </div>
                              </div>

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 text-bold-500">
                                  <label class="basic-url text-bold-500 tx-14" [ngClass]="
                                      check_el(dt.id, dt.Datefrom) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Period of Insurance From
                                    <span class="red">*</span>
                                    :</label>
                                  <div class="custom-file row">
                                    <div class="form-group position-relative has-icon-right">
                                      <input type="text" bsDatepicker id="datefrom{{ i }}" #date1 autocomplete="off" [disabled]="!show_button" [readonly]="true" class="form-control ml-3" [ngClass]="
                                          check_el(dt.id, dt.Datefrom) == true && dt.submit_active == 'active'
                                            ? 'border-error'
                                            : ''
                                        " (ngModelChange)="datePlusday3(date1.value, dt, 'period_ins_from')" [(ngModel)]="dt.Datefrom" [maxDate]="ConvertTypeDate(dt.Dateto)" [bsConfig]="{ dateInputFormat: 'DD MMM YYYY', showWeekNumbers: false }" />
                                      <div class="input-group-btn">
                                        <label class="form-control-position" for="datefrom{{ i }}">
                                          <i class="material-icons tx-top-blue cursor-pointer">today</i>
                                        </label>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 text-bold-500">
                                  <label class="basic-url text-bold-500 tx-14" [ngClass]="
                                      check_el(dt.id, dt.Dateto) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Period of Insurance To <span class="red">*</span> :</label>
                                  <div class="custom-file row">
                                    <div class="form-group position-relative has-icon-right">
                                      <input type="text" bsDatepicker id="dateto{{ i }}" [disabled]="!show_button" #date2 [readonly]="true" [ngClass]="
                                          check_el(dt.id, dt.Dateto) == true && dt.submit_active == 'active'
                                            ? 'border-error'
                                            : ''
                                        " autocomplete="off" class="form-control ml-3" (ngModelChange)="datePlusday3(date2.value, dt, 'period_ins_to')" [(ngModel)]="dt.Dateto" [minDate]="ConvertTypeDate(dt.Datefrom)" [bsConfig]="{ dateInputFormat: 'DD MMM YYYY', showWeekNumbers: false }" />
                                      <div class="input-group-btn">
                                        <label class="form-control-position" for="dateto{{ i }}">
                                          <i class="material-icons tx-top-blue cursor-pointer">today</i>
                                        </label>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500">Duration :</label>
                                  <div class="custom-file w-100">
                                    <!-- [(ngModel)]="dt.period_ins_dest" value={{duration(dt.period_ins_from,dt.period_ins_to)}}  -->
                                    <!-- value={{duration(dt.period_ins_from,dt.period_ins_to)}} -->
                                    <input type="text" class="" id="passportno_input" autocomplete="off" disabled value="{{ duration(dt.period_ins_from, dt.period_ins_to, i) }}" class="form-control" />
                                  </div>
                                </div>
                              </div>

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.destination) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Destination <span class="red">*</span> :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" [disabled]="!show_button" [ngClass]="
                                        check_el(dt.id, dt.destination) == true && dt.submit_active == 'active'
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [(ngModel)]="dt.destination" (ngModelChange)="model_action_change(dt.id)" class="form-control" />
                                  </div>
                                </div>

                                <div class="col-md-8 col-sm-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.ins_broker) == true && dt.submit_active == 'active'
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Broker <span class="red">*</span> :
                                  </label>
                                  <div class="custom-file w-100">
                                    <select class="form-control" style="height: 40px" [disabled]="!show_button" [(ngModel)]="dt.ins_broker" (ngModelChange)="model_action_change(dt.id)" [ngClass]="
                                        check_el(dt.id, dt.ins_broker) == true && dt.submit_active == 'active'
                                          ? 'border-error'
                                          : ''
                                      ">
                                      <option class="text-left" value="" disabled>-- Please Select --</option>
                                      <option *ngFor="let dt_broker of order_by_list(brokerDt)" [value]="dt_broker.id">
                                        {{ dt_broker.name }}
                                      </option>
                                    </select>
                                  </div>
                                </div>

                                <div class="col-4 tx-gray-700 tx-14 m-0 text-bold-500"></div>
                              </div>

                              <div class="row col-12 py-2 px-0 mx-0 tx-gray-700 tx-14 m-0 text-bold-500 gap-sm">
                                <div class="col-12 tx-gray-700 tx-14 m-0 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500">Remark :</label>
                                  <div class="custom-file w-100">
                                    <textarea type="" class="" rows="3" [disabled]="!show_button" id="passportno_input" autocomplete="off" [(ngModel)]="dt.remark" (ngModelChange)="model_action_change(dt.id)" class="form-control"></textarea>
                                  </div>
                                </div>
                              </div>

                              <div class="row p-2 mx-2 gap justify-content-md-end justify-content-sm-start">
                                <input type="file" accept="image/*" #file2 class="d-none" (change)="onFileSelect2($event)" />
                                <button class="btn btn-round bg-top-blue btn-min-width bg-top-blue font-weight-bold" style="color: #08508c; border: 1px solid #08508c; background-color: white" (click)="send_mail_Test2(dt.id, 1)" [disabled]="!show_button" [ngClass]="{ 'cursor-pointer': show_button, 'cursor-not-allowed': !show_button }">
                                  Send E-mail To Insurance
                                </button>

                                <button class="btn btn-round bg-top-blue btn-min-width bg-top-blue font-weight-bold" style="color: #08508c; border: 1px solid #08508c; background-color: white" (click)="send_mail_Test2(dt.id, 0)" [disabled]="!show_button" [hidden]="!status" [ngClass]="{ 'cursor-pointer': show_button, 'cursor-not-allowed': !show_button }">
                                  Send E-mail To Traveler
                                </button>
                              </div>

                              <div class="row col-12 pb-2 pt-4 px-0 mx-0">
                                <div class="col-12 tx-gray-700 tx-14 m-0 text-bold-500 pb-0 text-white" style="background-color: #08508c">
                                  <p class="pb-0 mb-0" style="text-decoration: underline">Certificate of Insurance</p>
                                </div>
                              </div>
                              <div class="row col-12 py-2 px-0 mx-0 gap-sm">
                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.certificates_no) == true &&
                                      dt.submit_active == 'active' &&
                                      btnSendMail === false
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Certificates No :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" [disabled]="!show_button" [ngClass]="
                                        check_el(dt.id, dt.certificates_no) == true &&
                                        dt.submit_active == 'active' &&
                                        btnSendMail === false
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [(ngModel)]="dt.certificates_no" (ngModelChange)="model_action_change(dt.id)" class="form-control" />
                                  </div>
                                </div>

                                <div class="col-md-4 col-sm-12 tx-gray-700 tx-14 text-bold-500">
                                  <label class="basic-url tx-14 text-bold-500" [ngClass]="
                                      check_el(dt.id, dt.certificates_total) == true &&
                                      dt.submit_active == 'active' &&
                                      btnSendMail === false
                                        ? 'text-error'
                                        : 'tx-gray-700'
                                    ">Total (THB) :</label>
                                  <div class="custom-file w-100">
                                    <input type="text" class="" id="passportno_input" [disabled]="!show_button" [ngClass]="
                                        check_el(dt.id, dt.certificates_total) == true &&
                                        dt.submit_active == 'active' &&
                                        btnSendMail === false
                                          ? 'border-error'
                                          : ''
                                      " autocomplete="off" [(ngModel)]="dt.certificates_total" (keypress)="onlyNumberKey($event)" (change)="dt.action_change = 'true'" (ngModelChange)="
                                        convertInt2('certificates_total', dt, dt.certificates_total, dt.id)
                                      " class="form-control" />
                                  </div>
                                </div>
                              </div>

                              <div class="input-group col-12 mt-0 py-2 mx-0">
                                <div class="custom-file w-100 pb-3 pt-4">
                                  <input type="file" id="file_id" #file accept=".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.txt,.pdf" class="d-none" (ngModelChange)="model_action_change(dt.id)" (change)="[onFileSelect($event, dt.sort_by), model_action_change(dt.id)]" />
                                  <input type="file" id="file_id" accept=".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.txt,.pdf" #file2 class="d-none" (ngModelChange)="model_action_change(dt.id)" (change)="[onFileSelect_2($event, dt.sort_by), model_action_change(dt.id)]" />

                                  <span (click)="show_button && file.click()" class="tx-14 blue" [attr.disabled]="show_button == false" [ngClass]="{ 'cursor-pointer': show_button, 'cursor-not-allowed': !show_button }">
                                    <i class="fa fa-upload font-weight-bold tx-14" aria-hidden="true"></i>
                                    &#32;&#32;Upload
                                  </span>

                                  <button [disabled]="show_button == false" class="
                                      btn btn-round
                                      bg-top-blue
                                      btn-min-width
                                      d-none
                                      ml-4
                                      mb-1
                                      font-weight-bold
                                      text-white
                                    " (click)="file.click()">
                                    Upload
                                  </button>

                                  &nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;
                                  <a class="blue" (click)="
                                      downloadFile(dt.file_coverage_path + dt.file_coverage_name, dt.file_coverage_name)
                                    ">Insurance Coverage</a>
                                  &nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;
                                  <a class="blue" (click)="show_button && SaveClick()" [ngClass]="{ 'cursor-pointer': show_button, 'cursor-not-allowed': !show_button }">Claim form Requisition</a>
                                </div>
                                &nbsp;&nbsp;
                                <span class="pt-2 ml-2">
                                  <div class="align-items-center mx-2" style="color: #08508c" *ngFor="let item of img_list; let i = index">
                                    <div *ngIf="
                                        item.id_level_1 == dt.sort_by &&
                                        item.filename != '' &&
                                        item.action_type != 'delete'
                                      ">
                                      <i class="material-icons tx-16 tx-top-blue tx-bold"> attach_file </i><a class="mx-2 text-primary txunderline text-bold-600" (click)="downloadFile(item.path + item.filename, item.filename)" target="_blank">{{ item.filename }}</a><i *ngIf="show_button == true" class="cursor-pointer fa fa-minus-circle danger" style="vertical-align: middle" (click)="deletefile(i, item.id)"></i>
                                    </div>
                                  </div>
                                </span>
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- </mat-form-field> -->
                      </mat-expansion-panel>
                    </ng-container>
                  </ng-container>

                  <!-- //!! BTN relative -->
                  <div class="d-flex flex-wrap gap my-3">
                    <ng-container *ngIf="show_button">
                      <button class="btn btn-round btn-min-width bg-top-pink font-weight-bold" style="color: white" (click)="openModalx(templatePDPA)">
                        <!-- (click)="Save_Change()" -->
                        Save
                      </button>
                      <button class="btn btn-round btn-min-width font-weight-bold" style="background-color: white; border: 1px solid #e21683; color: #e21683" (click)="Cancel_editClick()">
                        Cancel
                      </button>
                    </ng-container>
                  </div>
                  <!-- //!! BTN relative -->
                </div>
              </div>
            </div>
          </div>
          <button class="btn btn-round btn-top d-none" (click)="openModalx(templete_email)">Export</button>
          <button class="btn btn-round btn-top d-none" (click)="openModalx(template)">Export</button>
          <button class="d-none" #closeModel (click)="modalRef?.hide()"></button>
          <!-- Modal 1 -->
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #template>
  <div class="modal-body">
    <div class="row">
      <div class="col-12">
        <button type="button" class="close pb-2" style="color: red" data-dismiss="modal" aria-label="Close" (click)="modalRef?.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="col-12">
        <label for="sendxx" class="font-weight-bold tx-gray-700">Send to :</label>

        <input type="text" placeholder="" class="form-control" [(ngModel)]="mail_curent" [matAutocomplete]="mail_curent_val" (click)="set_modal()" (ngModelChange)="modelChanged($event)" />
        <mat-autocomplete #mail_curent_val="matAutocomplete">
          <mat-option *ngFor="let option of email_send" [value]="option.mail_to" [hidden]="option.mail_to == null || option.mail_to == '' ? true : false">
            {{ option.mail_to }}
          </mat-option>
        </mat-autocomplete>
      </div>
      <div class="col-12">
        <!-- (click)="add_email(sendx.value)" -->
        <!--  <button class="btn btn-round bg-top-blue text-bold-500 col-3  my-2"
                    (click)="add_email(mail_curent)" style="color:white">
                    Add
                </button> -->
        <button class="btn btn-round bg-top-blue text-bold-500 col-3 my-2" (click)="addemail(mail_curent)" style="color: white">
          Add
        </button>
      </div>
      <!-- *ngIf="listx.emp_id == emp_idS" -->
      <div class="col-12">
        <div class="form-group position-relative has-icon-right" *ngFor="let listx of Email_sendX; let ii = index">
          <div>
            <input type="text" class="form-control mb-1" [value]="listx.mail_to" />
            <div class="form-control-position">
              <i class="fa fa-times danger cursor-pointer" (click)="deleteRowx(ii)" aria-hidden="true"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12">
        <button class="btn btn-round bg-top-blue text-bold-500 col-3 my-2" *ngIf="Email_sendX.length > 0" style="color: white" (click)="SendEmail()">
          Send
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #templete_email>
  <div class="modal-header">
    <div class="col-sm-12">
      <span class="modal-title tx-20" id="my-modal-title">Send E-mail </span>
      <button type="button" class="close pb-2" style="color: red" data-dismiss="modal" aria-label="Close" (click)="modalRef?.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  </div>
  <!-- for Search Emp -->
  <div class="col-sm-12 py-2">
    <!-- Mail TO -->
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>TO</mat-label>
        <mat-chip-listbox #chipList [selectable]="selectable">
          <mat-chip *ngFor="let EmpList of MailList; let indx = index" 
           [removable]="removable" (removed)="remove(EmpList, indx, 'to')">
            {{ EmpList.displayname }}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip>
          <input placeholder="username@thaioilgroup.com" #fInput/>
          <!-- <input placeholder="username@thaioilgroup.com" matInput #fInput [formControl]="fCtrl" [matAutocomplete]="auto" (click)="set_modal()" [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur" (matChipInputTokenEnd)="add($event, 'to')" [(ngModel)]="inputText" (ngModelChange)="doFilter('inputText')" /> -->
        </mat-chip-listbox>
        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="[selected($event, 'to'), (fInput.value = '')]">
          <mat-option *ngFor="let EmpList of filteredEmp | async" [value]="EmpList" [hidden]="!CheckData(fInput.value)">
            {{ displayName(EmpList) }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>
    <!-- Mail TO -->
    <!-- <pre>{{MailList|json}}</pre> -->
    <!-- for Search Emp -->

    <!-- MailCC -->
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>CC</mat-label>
        <mat-chip-listbox #chipListCC >
          <mat-chip-option *ngFor="let EmpList of MailListCC; let indx = index" [selectable]="selectable" [removable]="removable" (removed)="remove(EmpList, indx, 'cc')">
            {{ EmpList.displayname }}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip-option>
          <input placeholder="username@thaioilgroup.com" #fInputcc/>
          <!-- <input placeholder="username@thaioilgroup.com" matInput #fInputcc [formControl]="fCtrlCC" (click)="set_modal()" [matAutocomplete]="autoCC" [matChipInputFor]="chipListCC" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur" (matChipInputTokenEnd)="add($event, 'cc')" [(ngModel)]="inputTextCC" (ngModelChange)="doFilter('inputTextCC')" /> -->
        </mat-chip-listbox>
        <mat-autocomplete #autoCC="matAutocomplete" (optionSelected)="[selected($event, 'cc'), (fInputcc.value = '')]">
          <mat-option *ngFor="let EmpList of filteredEmpCC | async" [value]="EmpList" [hidden]="!CheckData(fInputcc.value)">
            {{ displayName(EmpList) }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>
  </div>

  <div class="col-12 pb-2">
    <button class="btn btn-round bg-top-blue text-bold-500 btn-block col-3 py-2" (click)="Config_Email_Send(1)" style="color: white">
      Send
    </button>
  </div>

  <!-- MailCC -->
</ng-template>

<ng-template #templete_email2>
  <div class="modal-header">
    <div class="col-sm-12">
      <span class="modal-title tx-20" id="my-modal-title"> Send E-mail </span>
      <button type="button" class="close pb-2" style="color: red" data-dismiss="modal" aria-label="Close" (click)="modalRef?.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  </div>
  <!-- for Search Emp -->
  <div class="col-sm-12 py-2">
    <!-- Mail TO -->
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>TO</mat-label>
        <mat-chip-listbox #chipList>
          <mat-chip-option *ngFor="let EmpList of MailList; let indx = index" 
                    [selectable]="selectable" 
                    [removable]="removable" 
                    (removed)="remove(EmpList, indx, 'to')">
            {{ EmpList.displayname }}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip-option>
          <input placeholder="username@thaioilgroup.com" #fInput [formControl]="fCtrl"/>
          <!-- <input placeholder="username@thaioilgroup.com" 
                 matInput 
                 #fInput 
                 [formControl]="fCtrl" 
                 [matAutocomplete]="auto" 
                 (click)="set_modal()" 
                 [matChipInputFor]="chipList" 
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes" 
                 [matChipInputAddOnBlur]="addOnBlur" 
                 (matChipInputTokenEnd)="add($event, 'to')" 
                 [(ngModel)]="inputText" 
                 (ngModelChange)="doFilter(inputText)" /> -->
        </mat-chip-listbox>
        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event, 'to')">
          <mat-option *ngFor="let EmpList of filteredEmp | async" 
                      [value]="EmpList" 
                      [hidden]="!CheckData(fInput.value)">
            {{ displayName(EmpList) }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
      
    </div>
  </div>

  <div class="col-12 py-2">
    <input type="file" accept="file_extension" #file class="d-none" />

    <button [disabled]="show_button == false" style="color: white" class="btn btn-round bg-top-blue text-bold-500 btn-block col-3 py-2" (click)="file.click()">
      Upload
    </button>
  </div>

  <div class="col-12 pb-2">
    <button class="btn btn-round bg-top-blue text-bold-500 btn-block col-3 py-2" (click)="Config_Email_Send(2)" style="color: white">
      Send
    </button>
  </div>

  <!-- MailCC -->
</ng-template>

<ng-template #templete_email3>
  <div class="modal-header">
    <div class="col-sm-12 px-0 mx-0">
      <span class="modal-title tx-20" id="my-modal-title"><i class="fa fa fa-envelope px-1"></i> Send E-mail </span>
      <button type="button" class="close pb-2" style="color: red" data-dismiss="modal" aria-label="Close" (click)="modalRef?.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  </div>
  <!-- for Search Emp -->
  <div class="col-sm-12 py-2">
    <!-- Mail TO -->
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>TO</mat-label>
        <mat-chip-listbox #chipList >
          <mat-chip-option *ngFor="let EmpList of MailList; let indx = index" [selectable]="selectable" [removable]="removable" (removed)="remove(EmpList, indx, 'to')">
            {{ EmpList.displayname }}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip-option>
          <input placeholder="username@thaioilgroup.com" #fInput/>
          <!-- <input placeholder="username@thaioilgroup.com"
                 matInput
                 #fInput
                 [formControl]="fCtrl"
                 [matAutocomplete]="auto"
                 (click)="set_modal()"
                 [matChipInputFor]="chipList"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 [matChipInputAddOnBlur]="addOnBlur"
                 (matChipInputTokenEnd)="add($event, 'to')"
                 [(ngModel)]="inputText"
                 (ngModelChange)="doFilter('inputText')" /> -->
        </mat-chip-listbox>
        
        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="[selected($event, 'to'), (fInput.value = '')]">
          <mat-option *ngFor="let EmpList of filteredEmp | async" [value]="EmpList" [hidden]="!CheckData(fInput.value)">
            {{ displayName(EmpList) }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>
    <!-- Mail TO -->
    <!-- <pre>{{MailList|json}}</pre> -->
    <!-- for Search Emp -->

    <!-- MailCC -->
    <div class="form-group">
      <mat-form-field class="w-100">
        <mat-label>CC</mat-label>
        <mat-chip-listbox #chipListCC >
          <mat-chip-option *ngFor="let EmpList of MailListCC; let indx = index" [selectable]="selectable" [removable]="removable" (removed)="remove(EmpList, indx, 'cc')">
            {{ EmpList.displayname }}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip-option>
          <input placeholder="username@thaioilgroup.com" #fInputcc/>
          <!-- <input placeholder="username@thaioilgroup.com" matInput #fInputcc [formControl]="fCtrlCC" (click)="set_modal()" [matAutocomplete]="autoCC" matChipInputFor=""
           [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur" (matChipInputTokenEnd)="add($event, 'cc')" [(ngModel)]="inputTextCC" (ngModelChange)="doFilter('inputTextCC')" /> -->
        </mat-chip-listbox>
        <mat-autocomplete #autoCC="matAutocomplete" (optionSelected)="[selected($event, 'cc'), (fInputcc.value = '')]">
          <mat-option *ngFor="let EmpList of filteredEmpCC | async" [value]="EmpList" [hidden]="!CheckData(fInputcc.value)">
            {{ displayName(EmpList) }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>
  </div>

  <div class="col-12 pb-2">
    <button class="btn btn-round bg-top-blue text-bold-500 btn-block col-3 py-2" (click)="Config_Email_Send(1)" style="color: white">
      Send
    </button>
  </div>

  <!-- MailCC -->
</ng-template>
<ng-template #templatePDPA class="border-top-yellow">
  <div class="modal-header" id="modal-test">
    <div class="col-sm-12 px-0">
      <span class="modal-title tx-20" id="my-modal-title">
        <i class="fa fa-info-circle" aria-hidden="true"></i>
        Condition & Agreement
      </span>
      <button type="button" class="close pb-2" style="color: red" (click)="[modalRef?.hide()]">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  </div>
  <div class="modal-body">
    <div class="card box-shadow-0 mb-0 mx-0 mx-md-2">
      <div class="card-body table-responsive border-blue-grey border-lighten-5" style="max-height: 300px">
        <p class="tx-top-blue tx-14 text-bold-500 text-justify mb-0" [innerText]="pdpa_wording">{{ pdpa_wording }}</p>
      </div>
    </div>
  </div>
  <div class="modal-footer justify-content-center">
    <button type="button" class="btn btn-round btn-min-width btn-top white font-weight-bold tx-14" (click)="hide_modal('Accept', '')">
      Accept
    </button>
    <b #btncancel [hidden]="true"></b>
  </div>
  <!-- //endfor -->
</ng-template>